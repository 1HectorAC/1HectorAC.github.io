<!DOCTYPE html>
<html lang="en">

<head>
    <meta cahrset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
        integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <link rel="stylesheet" href="../css/default.css">
    <title> Battery Charge Blog</title>
</head>

<body>
    <div class="title text-center">
        <h1><a href="../index.html">Programming Portfolio</a></h1>
        <h5><i>By Hector Acosta-Cervantes</i></h5>
    </div>
    <div class="container text-center">
        <div class="blackPanel">
            <h5><a href="../personalProjectsPage.html">Personal Projects (Web Development)</a></h5>
            <h4>Battery Charge Blog (ASP.NET Core MVC)</h4>
        </div>
    </div>
    <div class="container text-center">
        <div class="blackPanel">
            <h4>Summary</h4>
            <hr style="background-color: white;" />
            <p>
                This website is about tracking the charge of old device batteries to maintain their lifespan. Users can
                log in to add devices and see which devices need to be recharged.. Link to the git hub repositiory <a
                    href="https://github.com/1HectorAC/BatteryCharge">here.</a>
            </p>
        </div>
        <div class="row">
            <div class="col-md-6">
                <div class="blackPanel">
                    <h4>Goal</h4>
                    <hr style="background-color: white;" />
                    <p>The goal was to get more familiar with ASP.NET Core MVC web framework. I have some experience
                        with ASP.NET MVC so most of my focus was on understanding some of the changes between the two.
                    </p>
                </div>
            </div>
            <div class="col-md-6">
                <div class="blackPanel">
                    <h4>Tools</h4>
                    <hr style="background-color: white;" />
                    <p>
                        The main language I used was C#. ASP.NET Core MVC web framework was used and Visual Studio 2021
                        was my IDE. I also use SQL Server with SQL Management Studio.
                    </p>
                </div>
            </div>
        </div>
        <div class="blackPanel">
            <h4>Step 1 (Database):</h4>
            <hr style="background-color: white;" />
            <p>I used a database first approach so one of my first task was just setting up a database. The database was
                pretty simple with just 2 table. The two tables were BatteryTrackerUser and Device.</p>
            <p>//Add diagram later.</p>
            <p>After that I used SQL management studio to make the database.</p>
            <br />
            <h4>Step 2 (Project Setup):</h4>
            <hr style="background-color: white;" />
            <p>On visual studio I created a project with the template "ASP.NET core Web App (MVC)." I also set the
                Authentication type to "Individual Account."</p>
            <br />
            <h4>Step 3 (Nuget Packages):</h4>
            <hr style="background-color: white;" />
            <p>The next step was to download all the necessary Nuget packages. With Visual Studio I can just select the
                "Nuget Packet Manager" option in the top "Tools" bar to add them. With the Nuget Packet Manager command
                prompt I can just run the following command to get what I need:</p>
            <pre class="codeBlockPanel mx-5"><code>
Install-Package Microsoft.EntityFrameworkCore.Tools
Install-Package Microsoft.EntityFrameworkCore.SqlServer
            </code></pre>
            <br />
            <h4>Step 4 (Setup Connection String):</h4>
            <hr style="background-color: white;" />
            <p>Step to take for setting up connection string:</p>
            <ol class="text-start">
                <li>On Visual Studio open "Server Explorer" (Can be accessed from top panels.)</li>
                <li>Right click on "Data Connection."</li>
                <li>Add connection (choses "Microsoft SQL Server", enter Server name and database name.)</li>
                <li>Make sure to test connection before clicking enter.</li>
                <li>Add connection string to "appsettings.json" file. Make sure to set connection string name to
                    "BatteryDBConnection." You can also add to secret file instead. Instuction on how <a
                        href="https://www.sharepointcafe.net/2021/04/secret-manager-in-dotnet-core.html#:~:text=Secret%20Manager%20is%20a%20feature%20in%20ASP.Net%20Core,database%20password%20will%20not%20be%20shared%20with%20them.">here.</a>
                </li>
            </ol>
            <h4>Step 5 (Generate Models and Context from DB):</h4>
            <hr style="background-color: white;" />
            <p>I then generated the models and context class using the database. I first go to the "Package Manager
                Console" and enter the following command to generate what I need:</p>
            <pre class="codeBlockPanel mx-5"><code>
Scaffold-DbContext Name=BatteryDBConnection Microsoft.EntityFrameworkCore.SqlServer -Tables 
        BatteryTrackerUser, Device -OutputDir Models -ContextDir Models -Context BatteryContext
            </code></pre>
            <p>This will generate 2 tables (BatteryTrackerUser and Device) and a model context (BatteryContext) in the
                Models folder.</p>
            </ol>
            <h4>Step 6 (Edit User Registration):</h4>
            <hr style="background-color: white;" />
            <p>I have a separate user table called "BatteryTrackerUser" that will need to be created at the same time the user makes an account. My intention in doing this was to keep some of the auto generated user stuff separated from my application. Now since the auto generated user files are abstracted away I will need to generate the files I need first. Here the are step to do this:</p>
            <ol class="text-start">
                <li>Right click on project folder.</li>
                <li>Select "Add" option.</li>
                <li>Select "New Scaffolded Item" option.</li>
                <li>On the new panel, Select "Identity."</li>
                <li>Checkmark the "Register" page. I also added a few other to edit styling.</li>
                <li>Done. The register page is now generated.</li>
            </ol>
            <p>I then needed to add the database context I created to the register page in order to have access to the "BatteryTrackerUser" table. A few things will need to be edited to make this work. Here are the steps taken to accomplish this:</p>
            <ol class="text-start">
                <li>Go to register page (Areas/Identity/Pages/Account/Register). Specifically the cs file that will drop down from the cshtml file.</li>
                <li>Add "BatteryContext" at the top of the page which is setup though Dependency Injection.  Add a private readonly BattteryContext variable, add  BatteryContext parameter to RegisterModels method, and set private BatteryContext variable to passed in parameter.</li>
            
            </ol>
        </div>
    </div>
</body>

</html>